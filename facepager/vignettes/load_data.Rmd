---
title: "load_data"
output: rmarkdown::html_vignette
description: >
  This vignette explains the different ways that the facepageR package offers to load and prepare data collected using Facepager.
vignette: >
  %\VignetteIndexEntry{load_data}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
library(tidyverse)
library(tidygraph)
library(jsonlite)
```


This vignette explains the different ways that the facepager package offers to load and prepare data collected using Facepager. 
As with all other packages you'll have to install the package and load the library first.
```{r setup}

# library(devtools)
# install_github("strohne/datavana/facepager")
library(facepager)

```

Now you can access the various functions that allow you to read data. Depending on the format of your data, you can use different functions. In total you can load the following data types:

* csv files

* one Facepager database or multiple Facepager databases at the same time (file extension .db)

* certain columns from a Facepager database



### Load a CSV file with `fp_read_csv2()`

`fp_read_csv2()` works the same way as the read_csv2 function from the tidyverse package. So you'll see a tibble containing a representation of the data in your csv file. 

```{r}
data <- fp_read_csv2(system.file("extdata", "example.csv", package = "facepager"))

# Reconstruct tree variables 
# (omit the seed nodes, otherwise they will be the root of the threads)
threads <- data %>% 
  filter(level > 0) %>% 
  tree_add_level(id, parent_id, created_time)  %>% 
  tree_add_mptt()
```

However, you do not have to export your data collected with Facepager as a csv file.


### Load a complete database with `fp_loaddatabase()`

With `fp_loaddatabase()` it is also possible to load the data directly from the .db file of the Facepager database.

The data will be contained in the response column as JSON. Therefore you need to convert the JSON data in the response to own columns with `fp_parse_response_data()`.

```{r}
data <- fp_load_database(system.file("extdata", "example.db", package = "facepager"))

data <- fp_parse_response_data(data)

```


In case you have performed several data collections with Facepager and accordingly have several .db files, you can load them easily with `fp_loaddatabases()` at the same time.This way you get one big combined dataset instead of loading the Facepager databases individually.

